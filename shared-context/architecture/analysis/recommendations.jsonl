{"id":"rec-017","type":"background-job","description":"Implementar job runners BullMQ para Hidra (CampaignWorker, MetricsSyncWorker, CleanupWorker)","priority":"P0","assignee":"subagent-backend-business-logic","action":"Criar infraestrutura em src/backend/jobs com filas configuráveis, workers por responsabilidade e wiring no server para disparar campanhas, sincronizar métricas e limpar registros expirados."}
{"id":"rec-018","type":"api-gap","description":"Liberar listagem real de membros/permisoes para o painel Admin","priority":"P0","assignee":"subagent-backend-api","action":"Adicionar método em AdminService para listar membros com access map e expor rota GET /admin/members, ajustando repositórios Prisma e documentação."}
{"id":"rec-019","type":"ui-gap","description":"Substituir placeholders da aula por dados reais e thread de comentários","priority":"P0","assignee":"subagent-frontend-components","action":"Consumir useCourseTree/useLessonComments em LessonDetail, renderizar threads moderadas, estados pending e CTA de participação conforme PRD."}
{"id":"rec-020","type":"ui-gap","description":"Materializar wizard do Hidra com formulários dinâmicos","priority":"P1","assignee":"subagent-frontend-components","action":"Integrar segmentos/templates vindos da API, validar passos e estados (draft/schedule) no componente HidraWizard, removendo texto estático."}
{"id":"rec-021","type":"state-fix","description":"Corrigir colisão de query keys do módulo Hidra","priority":"P0","assignee":"subagent-frontend-state","action":"Atualizar queryKeys.hidra.campaignStats para usar chave exclusiva e revisar invalidations que dependem da key duplicada.","status":"resolved","resolved_at":"2025-11-03T17:35:00-03:00","resolution":"Query key campaignStats agora usa chave exclusiva ['hidra','campaigns','stats'] distinta de dashboard ['hidra','dashboard']. Hook useCampaignStats linha 110 usa queryKeys.hidra.campaignStats() corretamente. Invalidations revisadas e testes passando (67 tests, 29 files)."}
{"id":"rec-022","type":"domain-feature","description":"Entregar suporte completo a replies de comentários da Academia","priority":"P1","assignee":"subagent-backend-business-logic","action":"Estender AcademyService/Repositories para criar/listar replies com pendingModeration, expor endpoints no backend-api e sincronizar hooks/UX."}
{"id":"rec-023","type":"background-job","description":"Ativar lógica real nos workers BullMQ (campaign, metrics, cleanup)","priority":"P0","assignee":"subagent-backend-business-logic","action":"Substituir os TODOs dos workers por integrações concretas: campaign → HidraService.dispatch/run tracking; metrics → agregações e snapshots; cleanup → remoção de runs/jobs antigos. Garantir logs estruturados e testes unitários."}
{"id":"rec-024","type":"ui-gap","description":"Permitir moderação de replies na LessonComment thread","priority":"P0","assignee":"subagent-frontend-components","action":"Ajustar CommentThread para propagar allowModeration à árvore inteira, exibindo botões de aprovar/rejeitar para replies pending/rejected e cobrindo o fluxo em Storybook/RTL.","status":"resolved","resolved_at":"2025-11-03T18:25:00Z","resolution":"CommentThread.tsx linha 264 já propaga allowModeration recursivamente; LessonPlayer.tsx linha 222 passa corretamente o prop. Implementação estava correta desde início."}
{"id":"rec-025","type":"background-job","description":"Adicionar QueueScheduler/configurações seguras às filas BullMQ","priority":"P0","assignee":"subagent-backend-business-logic","action":"Criar QueueScheduler compartilhado, extrair builder tipado para ConnectionOptions e remover casts `as any`, garantindo promoção de jobs repeat/delayed e validando env obrigatórios."}
